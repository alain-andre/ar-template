module Api
  module V1 
    # API v1 for the controller <%= class_name %>
    # * Standard response is in json
    class <%= class_name.camelize(:upper) %>Controller < ApplicationController
      before_action :set_<%= class_name.camelize(:lower) %>, only: [:show, :edit, :update, :destroy]
      respond_to :json

      # List all the <%= class_name %> of the DB
      def index
        respond_with <%= class_name.camelize(:upper) %>.all
      end

      # Return datas of the demanded <%= class_name %>
      def show
        respond_with <%= class_name.camelize(:upper) %>.find(params[:id])
      end

      # Return a new <%= class_name %>
      def new
        respond_with <%= class_name.camelize(:upper) %>.new
      end

      # Return datas of the demanded <%= class_name %>
      def edit
        respond_with <%= class_name.camelize(:upper) %>.find(params[:id])
      end

      # Create a new <%= class_name %>
      def create
        if @<%= class_name.camelize(:upper) %>.new(<%= class_name.camelize(:lower) %>_params)
          respond_with :no_content
        else
          respond_with @<%= class_name.camelize(:lower) %>.errors
        end
      end

      # Updates the given <%= class_name %>
      def update
        if @<%= class_name.camelize(:lower) %>.update(<%= class_name.camelize(:lower) %>_params)
          respond_with :no_content
        else
          respond_with @<%= class_name.camelize(:lower) %>.errors
        end
      end

      # Delete 
      def destroy
        if @<%= class_name.camelize(:lower) %>.destroy
          respond_with :no_content
        else
          respond_with @<%= class_name.camelize(:lower) %>.errors
        end
      end

      private
      # Use callbacks to share common setup or constraints between actions.
      def set_<%= class_name.camelize(:lower) %>
        @<%= class_name.camelize(:lower) %> = <%= class_name.camelize(:upper) %>.find(params[:id])
      end

      # Never trust parameters from the scary internet, only allow the white list through.
      def <%= class_name.camelize(:lower) %>_params
        params[:<%= class_name.camelize(:lower) %>]
      end

    end
  end
end